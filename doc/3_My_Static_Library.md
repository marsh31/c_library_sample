# 自作静的ライブラリ（.a）を作る

## 何を理解するか

- 静的ライブラリは「オブジェクトファイルをまとめたアーカイブ」。

- 作成には ar コマンドを使う：
  ```make
  gcc -c foo.c bar.c  # foo.o, bar.o を生成
  ar rcs libmylib.a foo.o bar.o
  ```

- 利用側からは：
  ```make
  gcc main.c -L. -lmylib -o main
  ```

- ポイント：
  - 呼び出したい関数の宣言を含むヘッダファイル（例：`mylib.h`）を作る。
  - ライブラリ利用者は`#include "mylib.h"`してリンクするだけ…という形にする。


## ar rcs libmylib.a foo.o bar.o とは

静的なライブラリ（`.a`ファイル）を作成するためのコマンド。
各オプションの意味は次の通り。  


### 各オプションの意味とコマンドの意味

- `ar`  
  UNIXのアーカイブ作成コマンド。複数のオブジェクトファイル（`.o`）を一つのアーカイブ（静的ライブラリ）に
  まとめるために使う。  

- `rcs`  
  - r: 既存のファイルを置き換える（replace）
  - c: アーカイブを新規に作成する（create）
  - s: シンボルテーブルを作成する（indexを作る）

なので、コマンドとしては、`foo.o`, `bar.o`を一つのアーカイブファイルにまとめる。
まとめたあと、索引を作成する。  

ここで、索引とは、このアーカイブにはどんな関数、変数がどこに入っているか？を知るための情報になる。
これがないと、アーカイブをリンクしようとしたときにうまくシンボルが解決できない場合があるため、必須。  


